# 클로저

클로저는 함수와 그 함수가 선언된 렉시컬 환경과의 조합.

### 렉시컬 환경

JavaScript에서 중요한 개념 중 하나로, 변수와 함수가 어디에서 정의되었는지에 따라 그 범위(scope)가 결정되는 방식입니다. 이를 통해 코드가 실행될 때 변수에 접근할 수 있는지 여부가 결정됩니다.

렉시컬 환경(Lexical Environment)

JavaScript 코드가 실행될 때 생성되는 내부적인 구조로, 해당 코드 블록 내에서 선언된 변수들과 상위 스코프 정보를 가지고 있습니다.
**환경 레코드(Environment Record)**와 **외부 렉시컬 환경 참조(Outer Lexical Environment Reference)**로 구성됩니다.

- 환경 레코드: 현재 범위(스코프)에서 선언된 변수, 함수 등의 정보를 기록하는 객체.
  외부 렉시컬 환경 참조: 상위 스코프를 참조하는 링크로, 이를 통해 외부의 렉시컬 환경에 정의된 변수와 함수에 접근할 수 있습니다.
  렉시컬 스코프(Lexical Scope):

- 코드가 작성된 위치에 따라 스코프가 결정됩니다. 즉, 함수가 어디에서 호출되었는지가 아니라 어디에서 선언되었는지가 중요합니다.
  함수 내부에서 변수에 접근할 때, 해당 변수가 현재 함수 내에 없으면 외부 렉시컬 환경을 따라가면서 변수를 찾습니다.

```
function outer() {
  let x = 10;
  function inner() {
    console.log(x);
  }
  inner();
}

outer();
```

outer 함수에 innter 함수가 중첩 함수로 선언되어 있는데 이때 inner 내부에서 자신을 포함하고 있는 외부 함수 outer의 x에 접근할 수 있다.

만약 inner 함수가 outer 함수 내부에 있지 않다면 inner 함수를 outer 함수 내부에서 호출해도 x의 값에 접근할 수 없다.

## 렉시컬 스코프

자바스크립트 엔진은 함수를 어디서 호출했는지가 중요한게 아니라 어디에 정의했는지에 따라 상위 스코프를 결정한다
이를 렉시컬 스코프(정적 스코프)라 한다.

```
const x = 1;

function foo() {
  const x = 10;
  bar();
}

function bar() {
  console.log(x);
}

foo(); // ?
bar(); // ?

```

foo와 bar 함수가 호출 된 값을 유추해보는것도 좋을거 같습니다.

렉시컬 환경의 "외부 렉시컬 환경에 대한 참조"에 저장할 참조값, 즉 상위 스코프에 대한 참조는 함수 정의가 평가되는 시점에 함수가 정의된 환경(위치)에 의해 결정된다. 이것이 렉시컬 스코프다.

## 함수 객체의 내부 슬롯

함수는 자신의 내부 슬롯 [[Environment]]에 자신이 정의된 환경, 즉 상위 스코프의 참조를 저장한다.
